
const fs = require('fs')
const { idlAttributeToCSSProperty } = require('../lib/parsers.js')
const path = require('path')
const { writeFile } = require('fs/promises')

const outputPath = path.resolve(__dirname, '../lib/implementedProperties.js')
const today = new Date().toISOString()
const header = `\n// autogenerated - ${today}\nmodule.exports = new Set([`
const content = fs
    .readdirSync(path.resolve(__dirname, '../lib/properties'))
    .reduce(
        (content, filename) => {
            const basename = path.basename(filename, '.js')
            const dashPrefix = /^webkit[A-Z]/.test(filename)
            const property = idlAttributeToCSSProperty(basename, dashPrefix)
            content += `\n\t'${property}',`
            return content
        },
        header)
    .concat('\n])\n')

try {
    writeFile(outputPath, content)
} catch (error) {
    console.error(error)
}
